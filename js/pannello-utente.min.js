function assegnaVoto(){$(".accept").click(function(){var t=$(this).prev().find("option:selected").text(),e=$(this).attr("id");$.post("pannello_utente.php",{voto:t,codicePren:e,funzione:1},function(t){try{1==(t=JSON.parse(t)).stato?generaAlert("green","Valutazione effettuata",t.messaggio):generaAlert("red","Errore",t.messaggio)}catch(t){generaAlertErroreGenerico()}})})}function rispostaEliminiazionePrenotazione(t){sistemaSchede(t),generaAlert("green","Successo","Attività eliminata con successo")}function validaCampiCambioPwd(t){var e=!0,i=$("#vecchia-password"),a=$("#password"),o=$("#password2");return 0===i.val().trim().length?(notificaErrore(i,"Inserire la <span lang='en'>password</span> corrente",t,$("#mod-pwd-form")),e=!1):validaPassword(a,o)||(e=!1),e}function salvaDatiForm(){var t=$("input").not(":input[type=submit], :input[type=password]"),e={};return $(t).each(function(){e[$(this).attr("id")]=$(this).val()}),e}function ripristinaDatiInizialiForm(t){var e=$("input").not(":input[type=submit], :input[type=password]");$("input[type=password]").val(""),$(e).each(function(){$(this).val(t[$(this).attr("id")])})}function stampaStorico(){$("#stampa-storico").on("click",function(){$(".schede-prenotazioni").hide(),$("#storico").show(),window.print(),$(".schede-prenotazioni").show()})}$(function(){stileCellaPagamento(),assegnaVoto(),stampaStorico(),$(".button-holder > .btn-cancella").on("click",function(){var t=$(this).attr("data-target"),e=validaData($("#"+t).find(".giorno").text())-new Date;Math.floor(e/864e5)<2?generaAlert("red","Errore","Non puoi cancellare la prenotazione con due giorni di anticipo."):$.confirm({boxWidth:calcolaDimensioneDialog(),useBootstrap:!1,type:"blue",title:"Conferma",content:"Procedere con l'eliminazione della prenotazione?",buttons:{Procedi:{btnClass:"btn-blue",action:function(){eliminaPrenotazione(t)}},Annulla:{}}})});var t=salvaDatiForm(),e=$("#dati-utente").prev(".alert.errore"),i=$("#mod-pwd-form").prev(".alert.errore");$("input[type=text]").attr("disabled","disabled"),$(".mostra-modifica").hide(),$("#modifica").on("click",function(){$(".mostra-modifica").slideDown(200),$(":text").not("#username").removeAttr("disabled"),$(this).hide()});$("label[for='vecchia-password']");$("#bottone-modifica-password").on("click",function(t){t.preventDefault(),t.stopPropagation(),pulisciErrori(i,$("#mod-pwd-form")),validaCampiCambioPwd(i)&&$.post("php/modifica_dati_utente.php",{VecchiaPwd:$("#vecchia-password").val(),NuovaPwd:$("#password").val()},function(t){try{1==(t=JSON.parse(t)).stato?generaAlert("green","Successo",t.messaggio):notificaErrore($("#vecchia-password"),t.messaggio,i,$("#mod-pwd-form"))}catch(t){generaAlertErroreGenerico()}})}),$("#annulla-modifica-pwd").on("click",function(t){t.preventDefault(),t.stopPropagation(),$("#mod-pwd-form")[0].reset()}),$("#invio-dati").on("click",function(i){i.preventDefault(),i.stopPropagation(),pulisciErrori(e,$("#dati-utente")),validaFormUtente(!1)&&$.post("php/modifica_dati_utente.php",$("#dati-utente").serialize(),function(i){try{1==(i=JSON.parse(i)).stato?(generaAlert("green","Successo",i.messaggio),t=salvaDatiForm(),$("#modifica").show()):notificaErrore($("#email"),i.messaggio,e,$("#dati-utente"))}catch(t){generaAlertErroreGenerico()}})}),$("#annulla").on("click",function(i){i.preventDefault(),i.stopPropagation(),$(":text").attr("disabled","disabled"),ripristinaDatiInizialiForm(t),pulisciErrori(e,$("#dati-utente")),$(".mostra-modifica").slideUp(200,function(){$(this).hide(),$("#modifica").show()})}),$("#elimina-account").on("click",function(){$.confirm({boxWidth:calcolaDimensioneDialog(),useBootstrap:!1,title:"Conferma",content:"Procedere con l'eliminazione dell'account? ",buttons:{Procedi:{btnClass:"btn-red",action:function(){$.confirm({boxWidth:calcolaDimensioneDialog(),useBootstrap:!1,title:"Conferma",content:"Dopo l'eliminazione verrà automaticamente effettuato il <span lang='en'>logout</span> e il tuo <span lang='en'>account</span> sarà eliminato. Confermi di voler di eliminare l'<span lang='en'>account</span>?",buttons:{eliminaAccount:{text:"Elimina <span lang='en'>account</span>",btnClass:"btn-red",action:function(){eliminaAccount()}},Annulla:{}}})}},Annulla:{}}})})});